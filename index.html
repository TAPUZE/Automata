<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoCity Israel: Master Plan V4</title>
    
    <!-- React Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js" crossorigin></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        /* --- CORE STYLES --- */
        body { 
            background-color: #030712; 
            color: #e2e8f0; 
            overflow: hidden; 
            font-family: 'Inter', sans-serif; 
        }

        /* Error Log (Hidden by default) */
        #error-log { display: none; position: fixed; top: 0; left: 0; width: 100%; background: #991b1b; color: white; padding: 20px; z-index: 9999; font-family: monospace; }
        
        /* Font Utilities */
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Glassmorphism */
        .glass-panel {
            background: rgba(10, 15, 30, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(56, 189, 248, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        /* Animations */
        @keyframes subtlePan {
            0% { transform: scale(1.05) translate(0, 0); }
            50% { transform: scale(1.05) translate(-1%, -1%); }
            100% { transform: scale(1.05) translate(0, 0); }
        }
        .bg-pan { animation: subtlePan 30s infinite ease-in-out; }

        .modal-enter { animation: modalIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .bar-fill { transition: height 1.2s cubic-bezier(0.2, 0.8, 0.2, 1); }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #38bdf8; }
    </style>
</head>
<body>
    <!-- Fallback / Loading Screen -->
    <div id="loading" class="h-screen w-full flex flex-col items-center justify-center bg-slate-950 text-cyan-500 font-mono">
        <div class="animate-spin mb-4 text-4xl">☼</div>
        <div>INITIALIZING AUTOCITY OS...</div>
    </div>

    <!-- Error Catcher -->
    <div id="error-log"></div>

    <div id="root"></div>

    <!-- SCRIPT LOGIC -->
    <script>
        // Global Error Handler
        window.onerror = function(msg, source, lineno) {
            document.getElementById('loading').style.display = 'none';
            const log = document.getElementById('error-log');
            log.style.display = 'block';
            log.innerHTML = `<strong>SYSTEM ERROR:</strong> ${msg} <br> <small>${source}:${lineno}</small>`;
        };
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS (Safe Inline SVGs) ---
        const Icons = {
            Right: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m9 18 6-6-6-6"/></svg>,
            Left: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m15 18-6-6 6-6"/></svg>,
            X: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 6 6 18"/><path d="m6 6 18 18"/></svg>,
            Bot: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="12" x="3" y="6" rx="2"/><path d="M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/></svg>,
            Chip: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="16" height="16" x="4" y="4" rx="2"/><rect width="6" height="6" x="9" y="9" rx="1"/><path d="M9 1v3"/><path d="M15 1v3"/><path d="M9 20v3"/><path d="M15 20v3"/><path d="M20 9h3"/><path d="M20 14h3"/><path d="M1 9h3"/><path d="M1 14h3"/></svg>,
            Globe: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>,
            Cube: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m21 16-9 5-9-5"/><polygon points="3 8 12 3 21 8 12 13 3 8"/></svg>
        };

        // --- DATA ---
        // Using stable Unsplash IDs for images to avoid broken links
        const slides = [
            {
                id: '1', layout: 'hero',
                title: 'AUTOCITY ISRAEL', subtitle: 'ZERO-LABOR METROPOLIS', tag: 'NEGEV // 2026',
                bg: 'https://images.unsplash.com/photo-1480714378408-67cf0d13bc1b?auto=format&fit=crop&q=80&w=2000',
                details: { title: 'Vision', text: 'AutoCity is not just a real estate project; it is a "Hardware-as-a-Service" platform. By burying logistics and utilizing robotic maintenance, we reduce municipal OPEX by 35% and solve the construction labor crisis.' }
            },
            {
                id: '2', layout: 'stats',
                title: 'THE CRISIS', subtitle: 'SYSTEM FAILURE IMMINENT',
                cards: [
                    { label: 'LABOR GAP', val: '450k', sub: 'Missing Workers', desc: 'Israel & US face massive construction labor shortages.' },
                    { label: 'OPEX WASTE', val: '35%', sub: 'Budget Loss', desc: 'Cities bleed money on manual waste collection and reactive maintenance.' },
                    { label: 'HOUSING', val: '$1.2M', sub: 'Avg Unit Price', desc: 'Tel Aviv is unaffordable. We must automate to lower costs.' }
                ]
            },
            {
                id: '3', layout: 'split',
                title: 'LAYER 1: VEINS', subtitle: 'SUBSURFACE LOGISTICS',
                bg: 'https://images.unsplash.com/photo-1617526738882-1ea945ce3e56?auto=format&fit=crop&q=80&w=2000',
                content: {
                    main: 'We separate logistics from life. A dedicated "Metro" layer for freight moves pallets, while a "Capillary" layer delivers packages to basements.',
                    details: 'TECH SPECS:\n\n1. PIPEDREAM LABS:\n• 12-inch uPVC pipes\n• 80km/h autonomous pods\n• <15 min delivery time\n\n2. ENVAC WASTE:\n• 70km/h pneumatic suction\n• 4-stream optical sorting\n• No garbage trucks on surface'
                }
            },
            {
                id: '4', layout: 'split',
                title: 'LAYER 2: BODY', subtitle: 'FACTORY-IN-THE-FIELD',
                bg: 'https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?auto=format&fit=crop&q=80&w=2000',
                content: {
                    main: 'The city constructs itself. Gantry printers and swarm robotics turn the construction site into an assembly line.',
                    details: 'TECH SPECS:\n\n1. ICON VULCAN:\n• 3D Prints 3,000 sqft/day\n• Material: Lavacrete (Negev Sand)\n\n2. HILTI JAIBOT:\n• Autonomous overhead drilling\n• BIM-to-Field accuracy +/- 1mm\n\n3. CANVAS:\n• AI Drywall Finishing (Level 5)'
                }
            },
            {
                id: '5', layout: 'split',
                title: 'LAYER 3: BRAIN', subtitle: 'DIGITAL TWIN OS',
                bg: 'https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&q=80&w=2000',
                content: {
                    main: 'We simulate the future before building it. The Digital Twin is the single source of truth for all city operations.',
                    details: 'TECH SPECS:\n\n1. NVIDIA OMNIVERSE:\n• Physics-accurate simulation\n• Synthetic data generation for AI training\n\n2. OPEN-RMF:\n• Robotics Middleware Framework\n• Traffic control for diverse robot fleets'
                }
            },
            {
                id: '6', layout: 'chart',
                title: 'MARKET DATA', subtitle: 'ISRAEL TECH ECOSYSTEM',
                data: [
                    { label: 'Smart City', val: 500, max: 800, suffix: 'M' },
                    { label: 'Const-Tech', val: 850, max: 1000, suffix: 'M' },
                    { label: 'Negev Pop', val: 1.2, max: 2.0, suffix: 'M' },
                    { label: 'Labor Gap', val: 45, max: 100, suffix: 'K' }
                ],
                details: 'DATA SOURCE:\n\n• Smart City Rev: Projected $503M by 2028 (CAGR 12.1%)\n• Const-Tech: $850M invested in Israeli startups (2024)\n• Gov Goal: Move 1.2M residents to Negev by 2035'
            },
            {
                id: '7', layout: 'chart',
                title: 'FINANCIALS', subtitle: 'UNIT ECONOMICS',
                data: [
                    { label: 'Infra Cost', val: 120, max: 150, suffix: '%' },
                    { label: 'Ops Cost', val: 65, max: 100, suffix: '%' },
                    { label: 'Waste Ops', val: 10, max: 100, suffix: '%' },
                    { label: 'IRR', val: 14, max: 20, suffix: '%' }
                ],
                details: 'FINANCIAL MODEL:\n\n• High CAPEX: Utilidors cost +20% upfront\n• Low OPEX: Automation saves 35% annually\n• Result: 14% IRR over 20 years, beating municipal bonds'
            },
            {
                id: '8', layout: 'hero',
                title: 'THE ASK', subtitle: '$100M SEED ROUND', tag: 'EQUITY & LAND',
                bg: 'https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&q=80&w=2000',
                details: { title: 'Use of Funds', text: '• $40M: Land Acquisition (Negev Tender)\n• $25M: Digital Twin & OS\n• $15M: Regulatory & Legal\n• $20M: Team & Operations' }
            }
        ];

        // --- COMPONENTS ---

        const Modal = ({ content, onClose }) => {
            if (!content) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur modal-enter" onClick={onClose}>
                    <div className="glass-panel w-full max-w-2xl p-8 rounded relative border border-cyan-500/30" onClick={e => e.stopPropagation()}>
                        <button onClick={onClose} className="absolute top-4 right-4 text-slate-500 hover:text-white"><Icons.X /></button>
                        <h3 className="text-xl font-bold text-cyan-400 mb-4 font-mono uppercase border-b border-cyan-900 pb-2">{content.title}</h3>
                        <div className="text-slate-300 font-mono text-sm leading-relaxed whitespace-pre-wrap h-64 overflow-y-auto">
                            {content.details || content.text}
                        </div>
                    </div>
                </div>
            );
        };

        const SlideHero = ({ slide, onOpen }) => (
            <div className="h-full flex flex-col items-center justify-center text-center relative z-10 px-4">
                <div className="mb-8 text-cyan-400"><Icons.Bot /></div>
                <h1 className="text-6xl md:text-9xl font-black text-white mb-6 tracking-tighter drop-shadow-2xl">{slide.title}</h1>
                <h2 className="text-2xl md:text-3xl text-cyan-200 font-light tracking-widest mb-12">{slide.subtitle}</h2>
                <div className="px-4 py-2 bg-cyan-950/50 border border-cyan-500/30 rounded text-xs font-mono text-cyan-400 mb-12">{slide.tag}</div>
                <button onClick={onOpen} className="px-8 py-3 bg-white text-black hover:bg-cyan-400 transition-colors font-bold text-sm tracking-wider flex items-center gap-2">
                    EXPLORE DATA <Icons.Right />
                </button>
            </div>
        );

        const SlideStats = ({ slide, onOpen }) => (
            <div className="h-full flex flex-col justify-center max-w-6xl mx-auto px-6 z-10 relative">
                <div className="mb-12 border-l-4 border-cyan-500 pl-6">
                    <h2 className="text-5xl font-black text-white mb-2">{slide.title}</h2>
                    <p className="text-xl text-slate-400 font-mono">{slide.subtitle}</p>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    {slide.cards.map((c, i) => (
                        <div key={i} className="glass-panel p-8 hover:border-cyan-500 transition-colors cursor-pointer group" onClick={() => onOpen({title: c.label, details: c.desc})}>
                            <div className="text-4xl font-bold text-white mb-2 font-mono group-hover:text-cyan-400">{c.val}</div>
                            <div className="text-xl font-bold text-cyan-200 mb-1">{c.label}</div>
                            <div className="text-xs text-slate-500 font-mono uppercase">{c.sub}</div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const SlideSplit = ({ slide, onOpen }) => (
            <div className="h-full flex flex-col md:flex-row z-10 relative">
                <div className="flex-1 flex flex-col justify-center p-12 bg-black/60 backdrop-blur-sm border-r border-slate-800">
                    <div className="mb-4 text-cyan-500 font-mono text-xs">SYSTEM ARCHITECTURE</div>
                    <h2 className="text-5xl font-black text-white mb-4">{slide.title}</h2>
                    <h3 className="text-xl text-slate-300 mb-8 font-light tracking-widest">{slide.subtitle}</h3>
                    <p className="text-lg text-slate-400 leading-relaxed mb-8 border-l-2 border-slate-700 pl-4">
                        {slide.content.main}
                    </p>
                    <button onClick={() => onOpen({title: slide.subtitle + ' SPECS', details: slide.content.details})} className="self-start text-cyan-400 hover:text-white font-mono text-sm flex gap-2 border-b border-cyan-500 pb-1">
                        VIEW BLUEPRINTS <Icons.Right />
                    </button>
                </div>
                <div className="flex-1"></div> 
            </div>
        );

        const SlideChart = ({ slide, onOpen }) => (
            <div className="h-full flex flex-col justify-center max-w-5xl mx-auto px-6 z-10 relative">
                <div className="text-center mb-12">
                    <h2 className="text-4xl font-bold text-white mb-2">{slide.title}</h2>
                    <p className="text-slate-400 font-mono">{slide.subtitle}</p>
                </div>
                <div className="glass-panel p-12 h-96 flex items-end justify-between gap-8" onClick={() => onOpen({title: 'Data Source', details: slide.details})}>
                    {slide.data.map((d, i) => (
                        <div key={i} className="flex-1 flex flex-col items-center gap-4 h-full justify-end group cursor-pointer">
                            <div className="mb-2 opacity-0 group-hover:opacity-100 transition-opacity text-cyan-300 font-mono text-xs bg-black px-2 py-1 border border-cyan-900">
                                {d.val}{d.suffix}
                            </div>
                            {/* Tech-Look: Solid Cyan Bars */}
                            <div className="w-full bg-cyan-600 opacity-80 group-hover:opacity-100 group-hover:bg-cyan-400 bar-fill shadow-[0_0_10px_rgba(8,145,178,0.3)]" 
                                 style={{ height: `${(d.val / d.max) * 100}%` }}></div>
                            <div className="text-xs font-bold text-slate-500 group-hover:text-white font-mono uppercase tracking-widest">{d.label}</div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const App = () => {
            const [idx, setIdx] = useState(0);
            const [modal, setModal] = useState(null);

            useEffect(() => {
                // Remove loading screen once React mounts
                const loader = document.getElementById('loading');
                if(loader) loader.style.display = 'none';
            }, []);

            const next = () => setIdx(c => Math.min(c + 1, slides.length - 1));
            const prev = () => setIdx(c => Math.max(c - 1, 0));

            // Keyboard nav
            useEffect(() => {
                const handleKey = (e) => {
                    if (e.key === 'ArrowRight') next();
                    if (e.key === 'ArrowLeft') prev();
                    if (e.key === 'Escape') setModal(null);
                };
                window.addEventListener('keydown', handleKey);
                return () => window.removeEventListener('keydown', handleKey);
            }, []);

            const slide = slides[idx];

            return (
                <div className="h-screen w-full relative bg-slate-950 overflow-hidden text-slate-200">
                    
                    {/* Background Layer */}
                    <div className="absolute inset-0 z-0">
                        {slide.bg && (
                            <div className="absolute inset-0 bg-cover bg-center opacity-40 bg-pan transition-all duration-700"
                                 style={{ backgroundImage: `url(${slide.bg})` }}></div>
                        )}
                        <div className="absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/80 to-transparent"></div>
                        <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 brightness-100 contrast-150"></div>
                    </div>

                    {/* Header */}
                    <div className="absolute top-0 w-full p-6 flex justify-between z-40 pointer-events-none">
                        <div className="flex items-center gap-2 text-white">
                            <Icons.Chip />
                            <span className="font-bold tracking-widest text-xs">AUTOCITY_OS_V4.0</span>
                        </div>
                        <div className="font-mono text-xs text-slate-400">{idx + 1} / {slides.length}</div>
                    </div>

                    {/* Content */}
                    <div key={slide.id} className="h-full w-full modal-enter">
                        {slide.layout === 'hero' && <SlideHero slide={slide} onOpen={() => setModal(slide.details)} />}
                        {slide.layout === 'stats' && <SlideStats slide={slide} onOpen={setModal} />}
                        {slide.layout === 'split' && <SlideSplit slide={slide} onOpen={setModal} />}
                        {slide.layout === 'chart' && <SlideChart slide={slide} onOpen={setModal} />}
                    </div>

                    {/* Footer Nav */}
                    <div className="absolute bottom-0 w-full p-6 flex justify-between items-end z-40 pointer-events-none">
                        <div className="hidden md:block text-[10px] text-slate-600 font-mono">CONFIDENTIAL // KALMAN GREENFIELD</div>
                        <div className="flex gap-2 pointer-events-auto">
                            <button onClick={prev} disabled={idx===0} className="p-3 bg-slate-800/50 border border-slate-700 hover:border-cyan-500 hover:text-white transition-all disabled:opacity-20">
                                <Icons.Left />
                            </button>
                            <button onClick={next} disabled={idx===slides.length-1} className="p-3 bg-slate-800/50 border border-slate-700 hover:border-cyan-500 hover:text-white transition-all disabled:opacity-20">
                                <Icons.Right />
                            </button>
                        </div>
                    </div>

                    {/* Modal */}
                    <Modal content={modal} onClose={() => setModal(null)} />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
